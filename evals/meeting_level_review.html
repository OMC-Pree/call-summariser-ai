<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Assessment Review</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
            color: #2d3748;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.95;
        }

        /* Coach Email Input */
        .email-section {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
        }

        .email-section input {
            width: 100%;
            max-width: 400px;
            padding: 12px;
            border: 2px solid #667eea;
            border-radius: 6px;
            font-size: 1em;
            margin-top: 10px;
        }

        /* Dashboard Stats */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #718096;
            font-size: 0.95em;
            font-weight: 500;
        }

        /* Meeting Cards */
        .meeting-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            overflow: hidden;
            transition: transform 0.2s;
        }

        .meeting-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .meeting-header {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .meeting-id {
            font-size: 1.3em;
            font-weight: 600;
        }

        .agreement-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .agreement-full {
            background: #48bb78;
            color: white;
        }

        .agreement-partial {
            background: #ed8936;
            color: white;
        }

        .agreement-none {
            background: #f56565;
            color: white;
        }

        /* Comparison Grid - Side by Side */
        .comparison-wrapper {
            overflow-x: auto;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            min-width: 900px;
        }

        .system-column {
            padding: 30px;
            vertical-align: top;
            border-right: 2px solid #e2e8f0;
        }

        .system-column:last-child {
            border-right: none;
        }

        .system-column.third-party {
            background: linear-gradient(135deg, #fff9e6 0%, #ffeaa7 100%);
        }

        .system-column.ai-model {
            background: linear-gradient(135deg, #ebf8ff 0%, #bee3f8 100%);
        }

        .system-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(0,0,0,0.1);
        }

        .system-title {
            font-size: 1.2em;
            font-weight: 700;
            color: #2d3748;
        }

        .match-icon {
            font-size: 1.8em;
        }

        .rating-badge {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 25px;
            color: white;
            font-weight: 700;
            font-size: 1.1em;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .rating-critical, .rating-5 { background: #d32f2f; }
        .rating-high, .rating-4 { background: #f57c00; }
        .rating-medium, .rating-3 { background: #fbc02d; }
        .rating-low, .rating-2 { background: #388e3c; }
        .rating-marginal, .rating-1 { background: #689f38; }
        .rating-none, .rating-0 { background: #7cb342; }

        .summary-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .summary-section h4 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 1em;
            font-weight: 600;
        }

        .summary-text {
            color: #4a5568;
            line-height: 1.6;
            font-size: 0.95em;
        }

        .vulnerability-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .vulnerability-type {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .evidence-quote {
            background: #f7fafc;
            padding: 12px;
            border-radius: 6px;
            font-style: italic;
            color: #4a5568;
            margin: 8px 0;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .reasoning {
            background: #fffaf0;
            padding: 12px;
            border-radius: 6px;
            margin-top: 8px;
            font-size: 0.9em;
            color: #744210;
            line-height: 1.5;
        }

        .types-list {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .types-list ul {
            margin: 10px 0 0 20px;
            color: #4a5568;
        }

        .types-list li {
            margin: 5px 0;
            line-height: 1.5;
        }

        /* Action Buttons */
        .actions {
            padding: 20px 30px;
            background: #f7fafc;
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .btn-agree {
            background: #48bb78;
            color: white;
        }

        .btn-agree:hover {
            background: #38a169;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .btn-disagree {
            background: #f56565;
            color: white;
        }

        .btn-disagree:hover {
            background: #e53e3e;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .btn-skip {
            background: #a0aec0;
            color: white;
        }

        .btn-skip:hover {
            background: #718096;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .btn-transcript {
            background: #4299e1;
            color: white;
            margin-left: 10px;
        }

        .btn-transcript:hover {
            background: #3182ce;
        }

        .btn-show-models {
            background: #9f7aea;
            color: white;
        }

        .btn-show-models:hover {
            background: #805ad5;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        /* Correction Form */
        .correction-form {
            display: none;
            background: #f0f7ff;
            padding: 30px;
            margin: 20px 30px;
            border-radius: 10px;
            border: 2px solid #4299e1;
        }

        .correction-form.active {
            display: block;
        }

        .form-group {
            margin: 15px 0;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
            color: #2d3748;
        }

        .form-group select,
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            font-size: 1em;
        }

        .form-group textarea {
            min-height: 100px;
            font-family: inherit;
        }

        /* Other AI Models Section */
        .other-models-section {
            display: none;
            background: #f7f7ff;
            padding: 30px;
            margin: 20px 30px;
            border-radius: 10px;
            border: 2px solid #9f7aea;
        }

        .other-models-section.active {
            display: block;
        }

        .model-comparison {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #9f7aea;
        }

        .model-name {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .dashboard {
                grid-template-columns: repeat(2, 1fr);
            }

            .stat-value {
                font-size: 2em;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .system-column {
                border-right: none;
                border-bottom: 2px solid #e2e8f0;
            }

            .system-column:last-child {
                border-bottom: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Vulnerability Assessment Review</h1>
            <p class="subtitle">Coach Review Interface - Third-Party vs AI Model Comparison</p>
        </header>

        <!-- Coach Email Input -->
        <div class="email-section">
            <label><strong>Coach Email:</strong></label>
            <input type="email" id="coachEmail" placeholder="your.email@company.com">
            <p style="margin-top: 10px; color: #666; font-size: 0.9em;">
                Enter your email to track your reviews and save progress
            </p>
        </div>

        <!-- Performance Dashboard -->
        <div class="dashboard" id="dashboard">
            <div class="stat-card">
                <div class="stat-value" id="totalCount">0</div>
                <div class="stat-label">Total Meetings</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="reviewedCount">0</div>
                <div class="stat-label">Reviewed</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="pendingCount">0</div>
                <div class="stat-label">Pending</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="agreementCount">0</div>
                <div class="stat-label">Agreements</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="disagreementCount">0</div>
                <div class="stat-label">Disagreements</div>
            </div>
        </div>

        <!-- Meeting Comparisons -->
        <div id="meetingsContainer">
            <div style="text-align: center; padding: 40px; color: white; font-size: 1.2em;">
                Loading assessments...
            </div>
        </div>

    </div>

    <script>
        // API Configuration
        const API_ENDPOINT = 'https://zrjzpoao4d.execute-api.eu-west-2.amazonaws.com/Prod';

        let assessments = [];
        let reviews = {};

        // Initialize page
        async function init() {
            try {
                await fetchAssessments();
                calculateStats();
                renderMeetings();
            } catch (error) {
                console.error('Failed to load assessments:', error);
                document.getElementById('meetingsContainer').innerHTML =
                    '<div style="text-align: center; padding: 40px; color: white;">Error loading assessments. Please refresh the page.</div>';
            }
        }

        // Fetch assessments from API
        async function fetchAssessments() {
            const response = await fetch(`${API_ENDPOINT}/reviews/pending`);
            if (!response.ok) {
                throw new Error(`API returned ${response.status}`);
            }
            const data = await response.json();
            assessments = data.assessments || [];
            console.log(`Loaded ${assessments.length} assessments`);
        }

        // Calculate statistics
        function calculateStats() {
            const total = assessments.length;
            const reviewed = Object.keys(reviews).length;
            const pending = total - reviewed;

            let agreements = 0;
            Object.values(reviews).forEach(review => {
                if (review.action === 'agree') agreements++;
            });
            const disagreements = reviewed - agreements;

            document.getElementById('totalCount').textContent = total;
            document.getElementById('reviewedCount').textContent = reviewed;
            document.getElementById('pendingCount').textContent = pending;
            document.getElementById('agreementCount').textContent = agreements;
            document.getElementById('disagreementCount').textContent = disagreements;
        }

        // Get rating background color
        function getRatingColor(rating) {
            if (!rating) return '#9e9e9e';
            if (rating.includes('Critical') || rating.includes('/5')) return '#d32f2f';
            if (rating.includes('High') || rating.includes('/4')) return '#f57c00';
            if (rating.includes('Medium') || rating.includes('/3')) return '#fbc02d';
            if (rating.includes('Low') || rating.includes('/2')) return '#388e3c';
            if (rating.includes('Marginal') || rating.includes('/1')) return '#689f38';
            if (rating.includes('None') || rating.includes('/0')) return '#7cb342';
            return '#9e9e9e';
        }

        // Check agreement between third-party and AI
        function checkAgreement(assessment) {
            const aiResponse = assessment.ai_responses?.['claude-3-7-sonnet'];
            if (!aiResponse) return { icon: '‚ùì', badge: 'agreement-partial', text: 'No AI Assessment' };

            const ratingMatch = aiResponse.rating === assessment.overall_rating;

            // Check vulnerability types overlap
            const thirdPartyTypes = new Set(assessment.vulnerability_types || []);
            const aiTypes = new Set(aiResponse.vulnerability_types || []);
            const intersection = new Set([...thirdPartyTypes].filter(x => aiTypes.has(x)));

            if (ratingMatch && intersection.size === thirdPartyTypes.size && intersection.size === aiTypes.size) {
                return { icon: '‚úÖ', badge: 'agreement-full', text: 'Full Agreement' };
            } else if (ratingMatch || intersection.size > 0) {
                return { icon: 'üü°', badge: 'agreement-partial', text: 'Partial Agreement' };
            } else {
                return { icon: '‚ùå', badge: 'agreement-none', text: 'Disagreement' };
            }
        }

        // Render all meetings
        function renderMeetings() {
            const container = document.getElementById('meetingsContainer');

            if (assessments.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: white;">No assessments available.</div>';
                return;
            }

            const html = assessments.map(assessment => {
                const review = reviews[assessment.meeting_id];
                const isReviewed = !!review;

                // Hide reviewed meetings
                if (isReviewed) return '';

                const aiResponse = assessment.ai_responses?.['claude-3-7-sonnet'];
                const agreement = checkAgreement(assessment);

                return `
                    <div class="meeting-card" id="card-${assessment.meeting_id}">
                        <div class="meeting-header">
                            <div class="meeting-id">Meeting: ${assessment.meeting_id}</div>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <div class="agreement-badge ${agreement.badge}">${agreement.icon} ${agreement.text}</div>
                                <button class="btn btn-transcript" onclick="loadTranscript('${assessment.meeting_id}')">
                                    View Transcript
                                </button>
                            </div>
                        </div>

                        <div class="comparison-wrapper">
                            <div class="comparison-grid">
                                <!-- Third-Party (Aveni) Column -->
                                <div class="system-column third-party">
                                    <div class="system-header">
                                        <div class="system-title">Third-Party (Aveni)</div>
                                    </div>
                                    <div class="rating-badge" style="background: ${getRatingColor(assessment.overall_rating)};">${assessment.overall_rating}</div>

                                    <div class="types-list">
                                        <h4>Vulnerability Types:</h4>
                                        <ul>
                                            ${(assessment.vulnerability_types || []).map(type => `<li>${type}</li>`).join('')}
                                        </ul>
                                    </div>

                                    <div class="summary-section">
                                        <h4>Evidence:</h4>
                                        ${(assessment.evidence_quotes || []).map(quote =>
                                            `<div class="evidence-quote">${quote}</div>`
                                        ).join('')}
                                    </div>
                                </div>

                                <!-- AI Model (Claude 3.7) Column -->
                                <div class="system-column ai-model">
                                    <div class="system-header">
                                        <div class="system-title">AI Model (Claude 3.7)</div>
                                        <div class="match-icon">${agreement.icon}</div>
                                    </div>
                                    ${aiResponse ? `
                                        <div class="rating-badge" style="background: ${getRatingColor(aiResponse.rating)};">${aiResponse.rating}</div>

                                        ${aiResponse.reasoning ? `
                                            <div class="summary-section">
                                                <h4>Summary:</h4>
                                                <div class="summary-text">${aiResponse.reasoning}</div>
                                            </div>
                                        ` : ''}

                                        ${(aiResponse.vulnerability_types || []).map((type, idx) => {
                                            const evidence = aiResponse.evidence?.[idx] || '';
                                            return `
                                                <div class="vulnerability-item">
                                                    <div class="vulnerability-type">${type}</div>
                                                    ${evidence ? `<div class="evidence-quote">${evidence}</div>` : ''}
                                                </div>
                                            `;
                                        }).join('')}
                                    ` : '<div class="summary-section"><h4>No AI assessment available</h4></div>'}
                                </div>
                            </div>
                        </div>

                        <!-- Review Actions -->
                        <div class="actions">
                            <button class="btn btn-agree" onclick="agreeWithAssessment('${assessment.meeting_id}')">
                                ‚úì Agree - Assessment is Correct
                            </button>
                            <button class="btn btn-disagree" onclick="showCorrectionForm('${assessment.meeting_id}')">
                                ‚úó Disagree - Needs Correction
                            </button>
                            <button class="btn btn-skip" onclick="skipMeeting('${assessment.meeting_id}')">
                                ‚è≠ Skip for Now
                            </button>
                            ${assessment.model_consensus && assessment.model_consensus.models ? `
                                <button class="btn btn-show-models" onclick="toggleOtherModels('${assessment.meeting_id}')">
                                    ü§ñ Show Other AI Models
                                </button>
                            ` : ''}
                        </div>

                        <!-- Correction Form (hidden by default) -->
                        <div class="correction-form" id="form-${assessment.meeting_id}">
                            <h3 style="margin-bottom: 20px;">Provide Correct Assessment</h3>

                            <div class="form-group">
                                <label>Correct Overall Rating:</label>
                                <select id="rating-${assessment.meeting_id}">
                                    <option value="">-- Select --</option>
                                    <option value="Critical/5">Critical/5</option>
                                    <option value="High/4">High/4</option>
                                    <option value="Medium/3">Medium/3</option>
                                    <option value="Low/2">Low/2</option>
                                    <option value="Marginal/1">Marginal/1</option>
                                    <option value="None/0">None/0</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>Correct Vulnerability Types (comma-separated):</label>
                                <input type="text" id="types-${assessment.meeting_id}"
                                       placeholder="e.g., Health: Mental Health, Resilience: Over-indebtedness">
                            </div>

                            <div class="form-group">
                                <label>Reasoning for Correction:</label>
                                <textarea id="reasoning-${assessment.meeting_id}"
                                          placeholder="Explain why you disagree with the third-party assessment..."></textarea>
                            </div>

                            <div style="display: flex; gap: 12px;">
                                <button class="btn btn-agree" onclick="submitCorrection('${assessment.meeting_id}')">
                                    Submit Correction
                                </button>
                                <button class="btn btn-skip" onclick="hideCorrectionForm('${assessment.meeting_id}')">
                                    Cancel
                                </button>
                            </div>
                        </div>

                        <!-- Other AI Models (hidden by default) -->
                        ${assessment.model_consensus && assessment.model_consensus.models ? `
                            <div class="other-models-section" id="models-${assessment.meeting_id}">
                                <h3 style="margin-bottom: 20px; color: #2d3748;">üìä Model Consensus & Other AI Responses</h3>

                                <div class="model-comparison">
                                    <div class="model-name">üéØ Model Consensus Summary</div>
                                    <div class="summary-section">
                                        <h4>Consensus Strength:</h4>
                                        <p style="color: #4a5568; text-transform: capitalize;">${assessment.model_consensus.consensus_strength || 'N/A'}</p>
                                    </div>
                                    <div class="summary-section">
                                        <h4>Agreement Count:</h4>
                                        <p style="color: #4a5568;">${assessment.model_consensus.agreement_count || 0} out of ${assessment.model_consensus.total_models || 0} models</p>
                                    </div>
                                </div>

                                ${Object.entries(assessment.model_consensus.models || {}).map(([modelKey, modelData]) => `
                                    <div class="model-comparison">
                                        <div class="model-name">ü§ñ ${modelKey.replace(/-/g, ' ').toUpperCase()}</div>
                                        <div class="rating-badge" style="background: ${getRatingColor(modelData.rating)};">
                                            ${modelData.rating}
                                        </div>
                                        <div class="summary-section">
                                            <h4>Agreement with Third-Party:</h4>
                                            <p style="color: ${modelData.agrees_with_third_party ? '#48bb78' : '#f56565'};">
                                                ${modelData.agrees_with_third_party ? '‚úÖ Agrees' : '‚ùå Disagrees'}
                                            </p>
                                        </div>
                                        <div class="summary-section">
                                            <h4>Vulnerability Types:</h4>
                                            <ul>
                                                ${(modelData.types || []).map(type => `<li>${type}</li>`).join('')}
                                            </ul>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');

            container.innerHTML = html;
        }

        async function agreeWithAssessment(meetingId) {
            const email = document.getElementById('coachEmail').value;
            if (!email) {
                alert('Please enter your email first');
                return;
            }

            const meeting = assessments.find(m => m.meeting_id === meetingId);
            const review = {
                action: 'agree',
                meeting_id: meetingId,
                third_party_rating: meeting.overall_rating,
                third_party_types: meeting.vulnerability_types.join('; '),
                coach_email: email,
                timestamp: new Date().toISOString()
            };

            reviews[meetingId] = review;
            await saveReviewToDynamoDB(review);
            await fetchAssessments();
            calculateStats();
            renderMeetings();
        }

        function showCorrectionForm(meetingId) {
            document.getElementById(`form-${meetingId}`).classList.add('active');
        }

        function hideCorrectionForm(meetingId) {
            document.getElementById(`form-${meetingId}`).classList.remove('active');
        }

        async function submitCorrection(meetingId) {
            const email = document.getElementById('coachEmail').value;
            if (!email) {
                alert('Please enter your email first');
                return;
            }

            const correctedRating = document.getElementById(`rating-${meetingId}`).value;
            const correctedTypes = document.getElementById(`types-${meetingId}`).value;
            const reasoning = document.getElementById(`reasoning-${meetingId}`).value;

            if (!correctedRating || !correctedTypes || !reasoning) {
                alert('Please fill in all fields');
                return;
            }

            const meeting = assessments.find(m => m.meeting_id === meetingId);
            const review = {
                action: 'correct',
                meeting_id: meetingId,
                third_party_rating: meeting.overall_rating,
                third_party_types: meeting.vulnerability_types.join('; '),
                corrected_rating: correctedRating,
                corrected_types: correctedTypes,
                reasoning: reasoning,
                coach_email: email,
                timestamp: new Date().toISOString()
            };

            reviews[meetingId] = review;
            await saveReviewToDynamoDB(review);
            await fetchAssessments();
            calculateStats();
            renderMeetings();
        }

        function skipMeeting(meetingId) {
            const cards = document.querySelectorAll('.meeting-card');
            const currentCard = document.getElementById(`card-${meetingId}`);
            const currentIndex = Array.from(cards).indexOf(currentCard);

            if (currentIndex < cards.length - 1) {
                cards[currentIndex + 1].scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        async function loadTranscript(meetingId) {
            alert(`Loading transcript for ${meetingId}...\n\nThis will fetch from: ${API_ENDPOINT}/transcript/${meetingId}`);
        }

        async function saveReviewToDynamoDB(review) {
            try {
                const response = await fetch(`${API_ENDPOINT}/review`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(review)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('Failed to save review to DynamoDB:', errorData);
                    alert('Warning: Review saved locally but failed to save to database.');
                    return false;
                }

                const result = await response.json();
                console.log('Review saved to DynamoDB:', result);
                return true;
            } catch (error) {
                console.error('Error saving review to DynamoDB:', error);
                alert('Warning: Review saved locally but failed to save to database.');
                return false;
            }
        }

        function toggleOtherModels(meetingId) {
            const section = document.getElementById(`models-${meetingId}`);
            const button = event.target;

            if (section.classList.contains('active')) {
                section.classList.remove('active');
                button.textContent = 'ü§ñ Show Other AI Models';
            } else {
                section.classList.add('active');
                button.textContent = 'ü§ñ Hide Other AI Models';
            }
        }

        // Initialize on page load
        window.addEventListener('load', init);
    </script>
</body>
</html>
